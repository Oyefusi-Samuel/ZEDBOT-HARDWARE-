<?xml version="1.0"?>
<robot xmlns:xacro="http://ros.org/wiki/xacro">

  <gazebo>
    <plugin
      filename="ignition-gazebo-diff-drive-system"
      name="ignition::gazebo::systems::DiffDrive">
      <left_joint>left_wheel_joint</left_joint>
      <right_joint>right_wheel_joint</right_joint>
      <wheel_separation>0.39</wheel_separation>
      <wheel_radius>0.05</wheel_radius>
      <!--
      Odometry in the diff drive plugin is quite bad, therefore 
      a dedicated OdometryPublisher plugin is being used.
      As it can not be disabled we publish odom info to an unused topic
      -->
      <odom_topic>/unused/diff_drive_odometry</odom_topic>
      <tf_topic>/unused/diff_drive_tf</tf_topic>
      <odom_publish_frequency>1</odom_publish_frequency>
      <frame_id>unused_odom_diff_drive</frame_id>
      <child_frame_id>base_link</child_frame_id>
    </plugin>
  </gazebo>

  <!-- OdometryPublisher being used instead of Diff Drive's odometry -->
  <gazebo>
    <plugin
      filename="ignition-gazebo-odometry-publisher-system"
      name="ignition::gazebo::systems::OdometryPublisher">
      <odom_publish_frequency>30</odom_publish_frequency>
      <robot_base_frame>base_link</robot_base_frame>
      <odom_frame>odom</odom_frame>
    </plugin>
  </gazebo>

  <gazebo>
    <plugin
      filename="ignition-gazebo-joint-state-publisher-system"
      name="ignition::gazebo::systems::JointStatePublisher">
      <joint_name>left_wheel_joint</joint_name>
      <joint_name>right_wheel_joint</joint_name>
    </plugin>
  </gazebo>
  
</robot>